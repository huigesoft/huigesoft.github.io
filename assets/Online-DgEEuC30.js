import{i as z,e as D,f as m,q as f,s as E,D as F,r as s,n as P,g as b,o as h,w as l,x as e,z as w,p as $,b as g,t as x,E as _}from"./index-CLxOXX9K.js";const I=m.service.system,M=p=>z({method:"post",url:I+"/sys/online/page",data:p}).catch(D),N=p=>z({method:"post",url:I+"/sys/online/deleteById",params:p}).catch(D),O={__name:"Online",setup(p){const T=f(null),r=f(!1),d=f([]),o=E({loading:!1,open:!1,params:{total:0,page:1,size:m.pageInfo.pageSize,expressions:[{field:"username",query:"like",value:""},{field:"loginIp",query:"eq",value:""}],sorts:[{field:"loginTime",direction:"DESC"}]}}),u=()=>{r.value=!0,M(o.params).then(n=>{r.value=!1,n.success?(d.value=n.value.records,o.params.total=n.value.total,o.params.page=n.value.current):(d.value=[],_({message:n?.exception||n?.msg||"操作失败！",type:"error"}))})},V=n=>{r.value=!0,N({id:n.token}).then(a=>{r.value=!1,a.success?(_({message:"删除成功",type:"success"}),u()):_({message:a?.exception||a?.msg||"操作失败！",type:"error"})})};return F(()=>{u()}),(n,a)=>{const v=s("el-input"),c=s("el-form-item"),y=s("el-button"),k=s("el-form"),i=s("el-table-column"),C=s("el-popconfirm"),S=s("el-table"),B=s("el-pagination"),q=s("h-list-layout"),U=P("loading");return h(),b(q,null,{header:l(()=>[e(k,{inline:!0},{default:l(()=>[e(c,{label:"用户名"},{default:l(()=>[e(v,{modelValue:o.params.expressions[0].value,"onUpdate:modelValue":a[0]||(a[0]=t=>o.params.expressions[0].value=t),style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(c,{label:"IP地址"},{default:l(()=>[e(v,{modelValue:o.params.expressions[1].value,"onUpdate:modelValue":a[1]||(a[1]=t=>o.params.expressions[1].value=t),style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(c,null,{default:l(()=>[e(y,{type:"primary",icon:"Search",round:"",onClick:u},{default:l(()=>[...a[4]||(a[4]=[g("查询",-1)])]),_:1})]),_:1})]),_:1})]),main:l(()=>[$((h(),b(S,{ref_key:"tableRef",ref:T,style:{width:"100%"},height:"100%",data:d.value,"highlight-current-row":"",stripe:"","show-overflow-tooltip":""},{default:l(()=>[e(i,{type:"selection",width:"55",fixed:"left"}),e(i,{prop:"username",label:"用户名","min-width":"120"}),e(i,{prop:"loginTime",label:"登录时间","min-width":"150"},{default:l(t=>[g(x(n.$defaultDateTimeFormat(t.row.loginTime)),1)]),_:1}),e(i,{prop:"expireTime",label:"过期时间","min-width":"150"},{default:l(t=>[g(x(n.$defaultDateTimeFormat(t.row.expireTime)),1)]),_:1}),e(i,{prop:"loginIp",label:"登录IP","min-width":"120"}),e(i,{prop:"loginBrowser",label:"浏览器","min-width":"180"}),e(i,{prop:"action",label:"操作","min-width":50,fixed:"right",align:"center"},{default:l(t=>[e(C,{title:"确定要下线该用户吗？",onConfirm:R=>V(t.row)},{reference:l(()=>[e(y,{type:"danger",size:"small",title:"下线",icon:"DeleteFilled",circle:""})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[U,r.value]])]),footer:l(()=>[e(B,{"current-page":o.params.page,"onUpdate:currentPage":a[2]||(a[2]=t=>o.params.page=t),"page-size":o.params.size,"onUpdate:pageSize":a[3]||(a[3]=t=>o.params.size=t),total:o.params.total,layout:w(m).pageInfo.layout,"page-sizes":w(m).pageInfo.pageSizes,"pager-count":5,onChange:u,background:"",size:"small"},null,8,["current-page","page-size","total","layout","page-sizes"])]),_:1})}}};export{O as default};
