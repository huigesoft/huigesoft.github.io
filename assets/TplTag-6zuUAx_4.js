const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TplTagForm-K6TiWOkY.js","assets/utils-B5efKl0g.js","assets/tpl-tag-D_2g8AFQ.js","assets/index-CLxOXX9K.js","assets/index-Bj5WFYBL.css","assets/TplAlarm-X2Yg9_Po.js","assets/alarm-level-SqVy_6NR.js","assets/TplAlarm-8CVkSNQ_.css"])))=>i.map(i=>d[i]);
import{I as S,q as _,O as k,N as ee,s as le,f as I,J as A,D as te,r as s,n as ae,c as oe,o as B,x as l,w as t,z as x,p as ne,g as se,b as u,t as P,S as $,F as ie,E as v,d as h,K as z}from"./index-CLxOXX9K.js";import{p as re,d as ue,a as pe}from"./tpl-tag-D_2g8AFQ.js";const ve={__name:"TplTag",setup(de){const q=$(()=>h(()=>import("./TplTagForm-K6TiWOkY.js"),__vite__mapDeps([0,1,2,3,4]))),F=$(()=>h(()=>import("./TplAlarm-X2Yg9_Po.js"),__vite__mapDeps([5,3,4,6,2,7]))),R=S("tpl",{}),N=S("tplId",null),g=_(null);z("tagId",g);const c=_(null);z("tag",c);const w=k("formRef"),T=k("tableRef"),D=k("alarmRef"),d=_(!1),y=_(!1),f=_(!1);z("alarmVisible",f);const C=ee([]),n=le({loading:!1,open:!1,params:{total:0,page:1,size:I.pageInfo.pageSize,expressions:[{field:"tagName",query:"like",value:""},{field:"tagTitle",query:"like",value:""},{field:"tplCode",query:"eq",value:R?.value?.tplCode}],sorts:[{field:"tagId"}]}}),m=()=>{d.value=!0,re(n.params).then(a=>{d.value=!1,a.success?(C.value=a.value.records,n.params.total=a.value.total,n.params.page=a.value.current):(C.value=[],v({message:a?.exception||a?.msg||"操作失败！",type:"error"}))})},O=()=>{g.value=null,c.value=null,y.value=!0},H=a=>{g.value=a.tagId,c.value=a,y.value=!0},L=a=>{d.value=!0,ue({id:a.tagId}).then(e=>{d.value=!1,e.success?(v({message:"删除成功",type:"success"}),m()):v({message:e?.exception||e?.msg||"操作失败！",type:"error"})})},M=()=>{const a=T.value.getSelectionRows();if(a.length===0)v({type:"error",message:"请选择要删除的内容？"});else{const e=a.map(p=>p.tagId);d.value=!0,pe(e).then(p=>{d.value=!1,p.success?(v({message:"删除成功",type:"success"}),m()):v({message:p?.exception||p?.msg||"操作失败！",type:"error"})})}},j=a=>{g.value=a.tagId,c.value=a,f.value=!0},J=a=>{switch(a){case 1:return"只读";case 2:return"只写";case 3:return"可读可写";default:return"未知"}};return A(N,a=>{n.params.expressions[2].value=R?.value?.tplCode,m()},{immediate:!0}),A(f,a=>{a||(g.value=null,c.value=null)}),te(()=>{m()}),(a,e)=>{const p=s("el-input"),V=s("el-form-item"),i=s("el-button"),U=s("el-popconfirm"),K=s("el-space"),G=s("el-form"),r=s("el-table-column"),Q=s("el-switch"),W=s("el-table"),X=s("el-pagination"),Y=s("h-list-layout"),E=s("h-modal"),Z=ae("loading");return B(),oe(ie,null,[l(Y,null,{header:t(()=>[l(G,{inline:!0},{default:t(()=>[l(V,{label:"点名"},{default:t(()=>[l(p,{modelValue:n.params.expressions[0].value,"onUpdate:modelValue":e[0]||(e[0]=o=>n.params.expressions[0].value=o),style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),l(V,{label:"点标题"},{default:t(()=>[l(p,{modelValue:n.params.expressions[1].value,"onUpdate:modelValue":e[1]||(e[1]=o=>n.params.expressions[1].value=o),style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),l(V,null,{default:t(()=>[l(i,{type:"primary",icon:"Search",round:"",onClick:m},{default:t(()=>[...e[13]||(e[13]=[u("查询",-1)])]),_:1})]),_:1}),l(K,null,{default:t(()=>[l(i,{type:"success",icon:"CirclePlus",onClick:O},{default:t(()=>[...e[14]||(e[14]=[u("新增",-1)])]),_:1}),l(U,{title:"确定要删除吗？",onConfirm:e[2]||(e[2]=o=>M())},{reference:t(()=>[l(i,{type:"danger",icon:"Remove"},{default:t(()=>[...e[15]||(e[15]=[u("删除",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),main:t(()=>[ne((B(),se(W,{ref_key:"tableRef",ref:T,style:{width:"100%"},height:"100%",data:C.value,"highlight-current-row":"",stripe:"","show-overflow-tooltip":""},{default:t(()=>[l(r,{fixed:"left",type:"selection",width:"40"}),l(r,{prop:"tagName",label:"点名","min-width":"120"}),l(r,{prop:"tagTitle",label:"点标题","min-width":"120"}),l(r,{prop:"dataType",label:"数据类型","min-width":"120"},{default:t(o=>[u(P(a.$dataTypeFormat(o.row.dataType)),1)]),_:1}),l(r,{prop:"decimalPlace",label:"小数位","min-width":"120"}),l(r,{prop:"tagDirection",label:"读写方向","min-width":"120"},{default:t(o=>[u(P(J(o.row.tagDirection)),1)]),_:1}),l(r,{prop:"tagOffset",label:"偏移量","min-width":"120"}),l(r,{prop:"tagUnit",label:"单位","min-width":"120"}),l(r,{prop:"saveHis",label:"历史","min-width":"120"},{default:t(o=>[l(Q,{modelValue:o.row.saveHis,"onUpdate:modelValue":b=>o.row.saveHis=b,"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"保存","inactive-text":"不保存","before-change":()=>!1,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(r,{prop:"tagDesc",label:"点描述","min-width":"120"}),l(r,{prop:"action",label:"操作","min-width":150,fixed:"right",align:"center"},{default:t(o=>[l(i,{type:"primary",size:"small",title:"编辑",icon:"Edit",onClick:b=>H(o.row),circle:""},null,8,["onClick"]),l(i,{type:"warning",size:"small",title:"报警配置",icon:"BellFilled",onClick:b=>j(o.row),circle:""},null,8,["onClick"]),l(U,{title:"确定要删除吗？",onConfirm:b=>L(o.row)},{reference:t(()=>[l(i,{type:"danger",size:"small",title:"删除",icon:"Remove",circle:""})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[Z,d.value]])]),footer:t(()=>[l(X,{"current-page":n.params.page,"onUpdate:currentPage":e[3]||(e[3]=o=>n.params.page=o),"page-size":n.params.size,"onUpdate:pageSize":e[4]||(e[4]=o=>n.params.size=o),total:n.params.total,layout:x(I).pageInfo.layout,"page-sizes":x(I).pageInfo.pageSizes,"pager-count":5,onChange:m,background:"",size:"small"},null,8,["current-page","page-size","total","layout","page-sizes"])]),_:1}),l(E,{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=o=>y.value=o),title:"点表",width:"500px",onClose:e[9]||(e[9]=o=>w.value?.reset())},{footer:t(()=>[l(i,{onClick:e[5]||(e[5]=()=>y.value=!1)},{default:t(()=>[...e[16]||(e[16]=[u("关闭",-1)])]),_:1}),l(i,{type:"primary",onClick:e[6]||(e[6]=()=>w.value.save())},{default:t(()=>[...e[17]||(e[17]=[u("保存",-1)])]),_:1}),l(i,{type:"primary",onClick:e[7]||(e[7]=()=>w.value.saveAndAdd())},{default:t(()=>[...e[18]||(e[18]=[u("保存并新增",-1)])]),_:1})]),default:t(()=>[l(x(q),{ref_key:"formRef",ref:w,onOnSave:m},null,512)]),_:1},8,["modelValue"]),l(E,{modelValue:f.value,"onUpdate:modelValue":e[12]||(e[12]=o=>f.value=o),title:"报警配置","with-header":!1,width:"70%",style:{"min-width":"900px","max-width":"1100px"}},{footer:t(()=>[l(i,{onClick:e[10]||(e[10]=()=>f.value=!1)},{default:t(()=>[...e[19]||(e[19]=[u("关闭",-1)])]),_:1}),l(i,{type:"primary",onClick:e[11]||(e[11]=()=>D.value.save())},{default:t(()=>[...e[20]||(e[20]=[u("保存",-1)])]),_:1})]),default:t(()=>[l(x(F),{ref_key:"alarmRef",ref:D},null,512)]),_:1},8,["modelValue"])],64)}}};export{ve as default};
