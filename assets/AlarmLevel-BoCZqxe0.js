import{I as L,q as c,J as T,r as s,n as E,p as $,g as j,o as B,w as l,x as e,z as D,E as g,s as J,f as N,D as K,c as G,b as w,t as O,F as H,K as Q}from"./index-CLxOXX9K.js";import{s as W,g as X,c as Y,p as Z,d as ee,a as le}from"./alarm-level-SqVy_6NR.js";import{u as te}from"./utils-B5efKl0g.js";const oe={__name:"AlarmLevelForm",emits:["onSave"],setup(q,{expose:V,emit:k}){const _=k,{hasText:y}=te(),x={levelCode:[{validator:async(a,r)=>{if(!y(r))return Promise.reject("请输入编码");const d={levelCode:r,idValue:o.value.levelId,id:"levelId"};await Y(d).then(m=>m.value?Promise.reject("编码已存在！"):Promise.resolve())},trigger:"blur"}],levelName:[{required:!0,message:"请输入名称",trigger:"blur"}]},u=L("id",null),f=c(!1),C=c(null),o=c({}),I=()=>{X({id:u.value}).then(a=>{a.success?o.value=a.value:(o.value={},g({message:a?.exception||a?.msg||"操作失败！",type:"error"}))})},U=()=>{C.value.validate().then(()=>{f.value=!0,W(o.value).then(a=>{f.value=!1,a?.success?(o.value=a.value,g({message:"保存成功！",type:"success"}),_("onSave")):g({message:a?.exception||a?.msg||"操作失败！",type:"error"})})})},i=()=>{u.value=null,o.value={levelMusic:0,levelPopup:0,levelOrder:1},C.value.clearValidate()},t=c(["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585"]);return T(u,a=>{a!==null&&I()},{immediate:!0}),V({save:U,reset:i}),(a,r)=>{const d=s("el-input"),m=s("el-form-item"),b=s("h-col"),P=s("el-color-picker"),v=s("el-switch"),h=s("el-input-number"),R=s("el-row"),S=s("el-form"),M=E("loading");return $((B(),j(S,{ref_key:"formRef",ref:C,model:o.value,"label-width":"120px",rules:x,"label-suffix":"："},{default:l(()=>[e(R,{gutter:10},{default:l(()=>[e(b,{sm:24},{default:l(()=>[e(m,{label:"等级编码",prop:"levelCode"},{default:l(()=>[e(d,{modelValue:o.value.levelCode,"onUpdate:modelValue":r[0]||(r[0]=p=>o.value.levelCode=p),readonly:D(y)(o.value?.levelId),clearable:""},null,8,["modelValue","readonly"])]),_:1})]),_:1}),e(b,{sm:24},{default:l(()=>[e(m,{label:"等级名称",prop:"levelName"},{default:l(()=>[e(d,{modelValue:o.value.levelName,"onUpdate:modelValue":r[1]||(r[1]=p=>o.value.levelName=p),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{sm:24},{default:l(()=>[e(m,{label:"报警颜色",prop:"levelColor"},{default:l(()=>[e(P,{modelValue:o.value.levelColor,"onUpdate:modelValue":r[2]||(r[2]=p=>o.value.levelColor=p),predefine:t.value},null,8,["modelValue","predefine"])]),_:1})]),_:1}),e(b,{sm:24},{default:l(()=>[e(m,{label:"播放音乐",prop:"levelMusic"},{default:l(()=>[e(v,{modelValue:o.value.levelMusic,"onUpdate:modelValue":r[3]||(r[3]=p=>o.value.levelMusic=p),"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{sm:24},{default:l(()=>[e(m,{label:"弹框提示",prop:"levelPopup"},{default:l(()=>[e(v,{modelValue:o.value.levelPopup,"onUpdate:modelValue":r[4]||(r[4]=p=>o.value.levelPopup=p),"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})]),_:1}),e(b,{sm:24},{default:l(()=>[e(m,{label:"排序号",prop:"levelOrder"},{default:l(()=>[e(h,{modelValue:o.value.levelOrder,"onUpdate:modelValue":r[5]||(r[5]=p=>o.value.levelOrder=p),min:1,max:1e3,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])),[[M,f.value]])}}},re={__name:"AlarmLevel",setup(q){const V=c(null),k=c(null),_=c(!1),y=c(!1),z=c([]),x=c(null);Q("id",x);const u=J({loading:!1,open:!1,params:{total:0,page:1,size:N.pageInfo.pageSize,expressions:[{field:"levelCode",query:"like",value:""},{field:"levelName",query:"like",value:""}],sorts:[{field:"levelOrder"}]}}),f=()=>{_.value=!0,Z(u.params).then(i=>{_.value=!1,i.success?(z.value=i.value.records,u.params.total=i.value.total,u.params.page=i.value.current):(z.value=[],g({message:i?.exception||i?.msg||"操作失败！",type:"error"}))})},C=()=>{x.value=null,y.value=!0},o=i=>{x.value=i.levelId,y.value=!0},I=i=>{_.value=!0,ee({id:i.levelId}).then(t=>{_.value=!1,t.success?(g({message:"删除成功",type:"success"}),f()):g({message:t?.exception||t?.msg||"操作失败！",type:"error"})})},U=()=>{const i=k.value.getSelectionRows();if(i.length===0)g({type:"error",message:"请选择要删除的内容？"});else{const t=i.map(a=>a.levelId);_.value=!0,le(t).then(a=>{_.value=!1,a.success?(g({message:"删除成功",type:"success"}),f()):g({message:a?.exception||a?.msg||"操作失败！",type:"error"})})}};return K(()=>{f()}),(i,t)=>{const a=s("el-input"),r=s("el-form-item"),d=s("el-button"),m=s("el-popconfirm"),b=s("el-space"),P=s("el-form"),v=s("el-table-column"),h=s("el-tag"),R=s("el-table"),S=s("el-pagination"),M=s("h-list-layout"),p=s("h-modal"),F=E("loading");return B(),G(H,null,[e(M,null,{header:l(()=>[e(P,{inline:!0},{default:l(()=>[e(r,{label:"类型编码"},{default:l(()=>[e(a,{modelValue:u.params.expressions[0].value,"onUpdate:modelValue":t[0]||(t[0]=n=>u.params.expressions[0].value=n),style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(r,{label:"类型名称"},{default:l(()=>[e(a,{modelValue:u.params.expressions[1].value,"onUpdate:modelValue":t[1]||(t[1]=n=>u.params.expressions[1].value=n),style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(r,null,{default:l(()=>[e(d,{type:"primary",icon:"Search",round:"",onClick:f},{default:l(()=>[...t[9]||(t[9]=[w("查询",-1)])]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(d,{type:"success",icon:"CirclePlus",onClick:C},{default:l(()=>[...t[10]||(t[10]=[w("新增",-1)])]),_:1}),e(m,{title:"确定要删除吗？",onConfirm:t[2]||(t[2]=n=>U())},{reference:l(()=>[e(d,{type:"danger",icon:"Remove"},{default:l(()=>[...t[11]||(t[11]=[w("删除",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),main:l(()=>[$((B(),j(R,{ref_key:"tableRef",ref:k,style:{width:"100%"},height:"100%",data:z.value,"highlight-current-row":"",stripe:"","show-overflow-tooltip":""},{default:l(()=>[e(v,{fixed:"left",type:"selection",width:"40"}),e(v,{prop:"levelCode",label:"编码","min-width":"120"}),e(v,{prop:"levelName",label:"名称","min-width":"120"}),e(v,{prop:"levelColor",label:"报警颜色","min-width":"120"},{default:l(n=>[e(h,{color:n.row.levelColor,effect:"dark"},{default:l(()=>[w(O(n.row.levelColor),1)]),_:2},1032,["color"])]),_:1}),e(v,{prop:"levelMusic",label:"播放音乐","min-width":"120"},{default:l(n=>[w(O(n.row.levelMusic===1?"是":"否"),1)]),_:1}),e(v,{prop:"levelPopup",label:"弹框提示","min-width":"120"},{default:l(n=>[w(O(n.row.levelPropup===1?"是":"否"),1)]),_:1}),e(v,{prop:"levelOrder",label:"排序号","min-width":"120"}),e(v,{prop:"action",label:"操作","min-width":100,fixed:"right",align:"center"},{default:l(n=>[e(d,{type:"primary",size:"small",title:"编辑",icon:"Edit",onClick:A=>o(n.row),circle:""},null,8,["onClick"]),e(m,{title:"确定要删除吗？",onConfirm:A=>I(n.row)},{reference:l(()=>[e(d,{type:"danger",size:"small",title:"删除",icon:"Remove",circle:""})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[F,_.value]])]),footer:l(()=>[e(S,{"current-page":u.params.page,"onUpdate:currentPage":t[3]||(t[3]=n=>u.params.page=n),"page-size":u.params.size,"onUpdate:pageSize":t[4]||(t[4]=n=>u.params.size=n),total:u.params.total,layout:D(N).pageInfo.layout,"page-sizes":D(N).pageInfo.pageSizes,"pager-count":5,onChange:f,background:"",size:"small"},null,8,["current-page","page-size","total","layout","page-sizes"])]),_:1}),e(p,{modelValue:y.value,"onUpdate:modelValue":t[7]||(t[7]=n=>y.value=n),title:"对象类型信息",width:"400",onClose:t[8]||(t[8]=n=>V.value?.reset())},{footer:l(()=>[e(d,{onClick:t[5]||(t[5]=()=>y.value=!1)},{default:l(()=>[...t[12]||(t[12]=[w("关闭",-1)])]),_:1}),e(d,{type:"primary",onClick:t[6]||(t[6]=()=>V.value.save())},{default:l(()=>[...t[13]||(t[13]=[w("保存",-1)])]),_:1})]),default:l(()=>[e(oe,{ref_key:"formRef",ref:V,onOnSave:f},null,512)]),_:1},8,["modelValue"])],64)}}};export{re as default};
