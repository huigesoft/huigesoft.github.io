import{u as N,k as R,q as f,s as S,v as j,r as l,n as A,c as F,o as k,h as n,x as o,w as s,p as H,g as K,y as $,z as L,A as w,b as M,f as G,B as I,C as J,E as _}from"./index-CLxOXX9K.js";import{u as O}from"./utils-B5efKl0g.js";const Q={class:"login"},W={class:"login-right"},X=["src"],se={__name:"HLogin",setup(Y){const h=G.baseUrl.pro,{hasText:y}=O(),{encryptB:i}=J(),g=N(),C=R(),v=f(),x=f(!1),t=S({username:"",password:"",checkCode:""}),c=f("c_"+new Date().getTime()),V={username:[{required:!0,message:"用户名不能为空！"}],password:[{required:!0,message:"密码不能为空！"}],checkCode:[{validator:async(p,e)=>{if(!y(e))return Promise.reject("请输入验证码");const a={code:c.value,value:e};await I(a).then(d=>d.value?Promise.resolve():Promise.reject("验证码错误"))},trigger:"blur"}]},b=j(()=>h+"/sys/image-code?code="+c.value),U=()=>{c.value="c_"+new Date().getTime()},z=()=>{v.value.validate().then(()=>{const p={username:i(t.username),password:i(t.password),checkCode:i(t.checkCode),code:i(c.value)};w(p).then(e=>{if(e.success){const a=e.value;g.setToken(a),g.setUsername(t.username),C.push({path:"/init"})}else e.data?.status===401?_.error({message:"登录失败！"}):e.exception?_.error({message:e.exception}):_.error({message:"登录失败！"})})})};return(p,e)=>{const a=l("el-col"),d=l("h-icon"),m=l("el-input"),u=l("el-form-item"),B=l("el-button"),D=l("el-space"),T=l("el-form"),P=l("el-card"),q=l("el-row"),E=A("loading");return k(),F("div",Q,[e[8]||(e[8]=n("div",{style:{position:"absolute",top:"20px",left:"50px"}},"Hawk Platform",-1)),o(q,{gutter:20,style:{width:"100%",height:"100vh"}},{default:s(()=>[o(a,{xs:24,sm:12},{default:s(()=>[...e[5]||(e[5]=[n("div",{class:"login-left"},null,-1)])]),_:1}),o(a,{xs:24,sm:12},{default:s(()=>[n("div",W,[o(P,{class:"login-panel"},{default:s(()=>[e[7]||(e[7]=n("div",{class:"login-title"},"登录",-1)),H((k(),K(T,{model:t,rules:V,ref_key:"formRef",ref:v,size:"large","element-loading-background":"rgba(0, 0, 0, 0)"},{default:s(()=>[o(D,{direction:"vertical",style:{width:"100%"}},{default:s(()=>[o(u,{prop:"username",size:"large"},{default:s(()=>[o(m,{placeholder:"用户名",modelValue:t.username,"onUpdate:modelValue":e[0]||(e[0]=r=>t.username=r),size:"large",type:"text"},{prefix:s(()=>[o(d,{type:"user-fill"})]),_:1},8,["modelValue"])]),_:1}),o(u,{prop:"password"},{default:s(()=>[o(m,{placeholder:"密码",modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=r=>t.password=r),size:"large",type:"password","show-password":"",onKeyup:e[2]||(e[2]=$(r=>L(w)(),["enter"]))},{prefix:s(()=>[o(d,{type:"lock-fill"})]),_:1},8,["modelValue"])]),_:1}),o(u,{prop:"checkCode"},{default:s(()=>[o(m,{placeholder:"请输入验证码",modelValue:t.checkCode,"onUpdate:modelValue":e[3]||(e[3]=r=>t.checkCode=r),style:{width:"50%"}},null,8,["modelValue"]),n("img",{src:b.value,class:"check-code",onClick:U,style:{cursor:"pointer"}},null,8,X)]),_:1}),o(u,{label:""},{default:s(()=>[o(B,{type:"primary",style:{width:"100%"},onClick:e[4]||(e[4]=r=>z()),size:"large"},{default:s(()=>[...e[6]||(e[6]=[M(" 登录 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])),[[E,x.value,void 0,{fullscreen:!0,lock:!0}]])]),_:1})])]),_:1})]),_:1})])}}};export{se as default};
