import{i as z,e as S,f as M,_ as oe,I as ne,q as C,J as se,r as s,n as X,p as Y,g as A,o as I,w as t,x as e,h as ie,c as G,b as g,F as K,G as L,t as Q,E as h,s as ue,D as re,z as W,K as me}from"./index-CLxOXX9K.js";import{u as de}from"./utils-B5efKl0g.js";const R=M.service.system,pe=v=>z({method:"post",url:R+"/sys/dict/saveOrUpdate",data:v}).catch(S),ce=v=>z({method:"post",url:R+"/sys/dict/page",data:v}).catch(S),fe=v=>z({method:"post",url:R+"/sys/dict/checkExists",data:v}).catch(S),ve=v=>z({method:"get",url:R+"/sys/dict/getById",params:v}).catch(S),_e=v=>z({method:"post",url:R+"/sys/dict/deleteById",params:v}).catch(S),ge=v=>z({method:"post",url:R+"/sys/dict/deleteByIds",data:v}).catch(S),be={key:0},ye={__name:"DictForm",emits:["onSave"],setup(v,{expose:B,emit:P}){const V=P,{hasText:U}=de(),w={dictCode:[{required:!0,message:"请输入名称",trigger:"blur"},{validator:async(n,a)=>{if(!U(a))return Promise.reject("请输入代码");const i={dictCode:a,idValue:o.value.dictId,id:"dictId"};await fe(i).then(d=>d.value?Promise.reject("代码已存在！"):Promise.resolve())},trigger:"blur"}],dictName:[{required:!0,message:"请输入名称",trigger:"blur"}],"items.*.itemText":[{required:!0,message:"请输入显示名",trigger:"blur"},{validator:(n,a,i)=>{const d=parseInt(n.field?.split(".")[1]);for(let p=0;p<o.value.items.length;p++)if(p!==d&&o.value.items[p].itemText===a)return i("显示名重复");return i()},trigger:"blur"}],"items.*.itemValue":[{required:!0,message:"请输入存储值",trigger:"blur"},{validator:(n,a,i)=>{const d=parseInt(n.field?.split(".")[1]);for(let p=0;p<o.value.items.length;p++)if(p!==d&&o.value.items[p].itemValue===a)return i("存储值重复");return i()},trigger:"blur"}]},f=[{label:"默认",value:"default"},{label:"主要",value:"primary"},{label:"成功",value:"success"},{label:"信息",value:"info"},{label:"警告",value:"warning"},{label:"危险",value:"danger"}],b=ne("id",null),D=C(!1),N=C(null),o=C({dictEnable:1,items:[]}),H=()=>{ve({id:b.value}).then(n=>{n.success?o.value=n.value:(o.value={},h({message:n?.exception||n?.msg||"操作失败！",type:"error"}))})},m=()=>{N.value.validate().then(()=>{D.value=!0,pe(o.value).then(n=>{D.value=!1,n?.success?(o.value=n.value,h({message:"保存成功！",type:"success"}),V("onSave")):h({message:n?.exception||n?.msg||"操作失败！",type:"error"})})})},l=()=>{b.value=null,o.value={dictEnable:1,items:[]},N?.value?.clearValidate()},y=n=>{o.value.items.splice(n+1,0,{itemEnable:1,itemStyle:"default"})},T=n=>{o.value.items.splice(n,1)},x=n=>{const a=n===0?o.value.items.length-1:n-1,i=o.value.items[n];o.value.items[n]=o.value.items[a],o.value.items[a]=i},F=n=>{const a=n===o.value.items.length-1?0:n+1,i=o.value.items[n];o.value.items[n]=o.value.items[a],o.value.items[a]=i};return se(b,n=>{n!==null?H():l()},{immediate:!0}),B({save:m,reset:l}),(n,a)=>{const i=s("el-input"),d=s("el-form-item"),p=s("h-col"),E=s("el-switch"),$=s("el-row"),_=s("el-col"),J=s("el-tag"),u=s("el-option"),q=s("el-select"),O=s("el-button"),Z=s("el-space"),ee=s("el-tab-pane"),te=s("el-tabs"),le=s("el-form"),ae=X("loading");return Y((I(),A(le,{ref_key:"formRef",ref:N,model:o.value,"label-width":"100px",rules:w,"label-suffix":"："},{default:t(()=>[e($,{gutter:10},{default:t(()=>[e(p,{sm:12},{default:t(()=>[e(d,{label:"字典代码",prop:"dictCode"},{default:t(()=>[e(i,{modelValue:o.value.dictCode,"onUpdate:modelValue":a[0]||(a[0]=c=>o.value.dictCode=c),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{sm:12},{default:t(()=>[e(d,{label:"字典名称",prop:"dictName"},{default:t(()=>[e(i,{modelValue:o.value.dictName,"onUpdate:modelValue":a[1]||(a[1]=c=>o.value.dictName=c)},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{sm:12},{default:t(()=>[e(d,{label:"描述",prop:"dictRemark"},{default:t(()=>[e(i,{modelValue:o.value.dictRemark,"onUpdate:modelValue":a[2]||(a[2]=c=>o.value.dictRemark=c),type:"textarea",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{sm:12},{default:t(()=>[e(d,{label:"状态",prop:"dictEnable"},{default:t(()=>[e(E,{modelValue:o.value.dictEnable,"onUpdate:modelValue":a[3]||(a[3]=c=>o.value.dictEnable=c),"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(te,null,{default:t(()=>[e(ee,{label:"字典项"},{default:t(()=>[e($,{gutter:32},{default:t(()=>[e(_,{span:5},{default:t(()=>[...a[4]||(a[4]=[g("字典名",-1)])]),_:1}),e(_,{span:5},{default:t(()=>[...a[5]||(a[5]=[g("字典值",-1)])]),_:1}),e(_,{span:2},{default:t(()=>[...a[6]||(a[6]=[g("状态",-1)])]),_:1}),e(_,{span:4},{default:t(()=>[...a[7]||(a[7]=[g("回显样式",-1)])]),_:1}),e(_,{span:7},{default:t(()=>[...a[8]||(a[8]=[g("操作",-1)])]),_:1})]),_:1}),a[9]||(a[9]=ie("br",null,null,-1)),(I(!0),G(K,null,L(o.value.items,(c,k)=>(I(),A($,{key:k,gutter:32,style:{"text-align":"center"}},{default:t(()=>[e(_,{span:5},{default:t(()=>[e(d,{"inline-message":"","label-width":"0px",prop:"items."+k+".itemText",rules:w["items.*.itemText"]},{default:t(()=>[e(i,{modelValue:c.itemText,"onUpdate:modelValue":r=>c.itemText=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),e(_,{span:5},{default:t(()=>[e(d,{"inline-message":"","label-width":"0px",prop:"items."+k+".itemValue",rules:w["items.*.itemValue"]},{default:t(()=>[e(i,{modelValue:c.itemValue,"onUpdate:modelValue":r=>c.itemValue=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),e(_,{span:2},{default:t(()=>[e(d,{"inline-message":"","label-width":"0px",prop:"items."+k+".itemEnable",rules:w["items.*.itemEnable"]},{default:t(()=>[e(E,{modelValue:c.itemEnable,"onUpdate:modelValue":r=>c.itemEnable=r,"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),e(_,{span:4},{default:t(()=>[e(d,{"inline-message":"","label-width":"0px",prop:"items."+k+".itemStyle",rules:w["items.*.itemStyle"]},{default:t(()=>[e(q,{modelValue:c.itemStyle,"onUpdate:modelValue":r=>c.itemStyle=r},{default:t(()=>[(I(),G(K,null,L(f,r=>e(u,{key:r.value,label:r.label,value:r.value},{default:t(()=>[r.value==="default"?(I(),G("span",be,Q(r.label),1)):(I(),A(J,{key:1,type:r.value},{default:t(()=>[g(Q(r.label),1)]),_:2},1032,["type"]))]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:2},1024),e(_,{span:7},{default:t(()=>[e(Z,{wrap:""},{default:t(()=>[e(O,{icon:"Plus",size:"small",onClick:r=>y(k),type:"primary",title:"新增",plain:""},null,8,["onClick"]),e(O,{icon:"Minus",size:"small",onClick:r=>T(k),type:"danger",title:"删除",plain:""},null,8,["onClick"]),e(O,{icon:"Top",size:"small",onClick:r=>x(k),type:"info",title:"上移",plain:""},null,8,["onClick"]),e(O,{icon:"Bottom",size:"small",onClick:r=>F(k),type:"info",title:"下移",plain:""},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["model"])),[[ae,D.value]])}}},Ve=oe(ye,[["__scopeId","data-v-491b2bfc"]]),ke={__name:"Dict",setup(v){const B=C(null),P=C(null),V=C(!1),U=C(!1),j=C([]),w=C(null);me("id",w);const f=ue({loading:!1,open:!1,params:{total:0,page:1,size:M.pageInfo.pageSize,expressions:[{field:"dictCode",query:"like",value:""},{field:"dictName",query:"like",value:""}],sorts:[{field:"createAt",direction:"DESC"}]}}),b=()=>{V.value=!0,ce(f.params).then(m=>{V.value=!1,m.success?(j.value=m.value.records,f.params.total=m.value.total,f.params.page=m.value.current):(j.value=[],h({message:m?.exception||m?.msg||"操作失败！",type:"error"}))})},D=()=>{w.value=null,U.value=!0},N=m=>{w.value=m.dictId,U.value=!0},o=m=>{V.value=!0,_e({id:m.dictId}).then(l=>{V.value=!1,l.success?(h({message:"删除成功",type:"success"}),b()):h({message:l?.exception||l?.msg||"操作失败！",type:"error"})})},H=()=>{const m=P.value.getSelectionRows();if(m.length===0)h({type:"error",message:"请选择要删除的内容？"});else{const l=m.map(y=>y.dictId);V.value=!0,ge(l).then(y=>{V.value=!1,y.success?(h({message:"删除成功",type:"success"}),b()):h({message:y?.exception||y?.msg||"操作失败！",type:"error"})})}};return re(()=>{b()}),(m,l)=>{const y=s("el-input"),T=s("el-form-item"),x=s("el-button"),F=s("el-popconfirm"),n=s("el-space"),a=s("el-form"),i=s("el-table-column"),d=s("el-switch"),p=s("el-table"),E=s("el-pagination"),$=s("h-list-layout"),_=s("h-modal"),J=X("loading");return I(),G(K,null,[e($,null,{header:t(()=>[e(a,{inline:!0},{default:t(()=>[e(T,{label:"字典代码"},{default:t(()=>[e(y,{modelValue:f.params.expressions[0].value,"onUpdate:modelValue":l[0]||(l[0]=u=>f.params.expressions[0].value=u),style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(T,{label:"字典名称"},{default:t(()=>[e(y,{modelValue:f.params.expressions[1].value,"onUpdate:modelValue":l[1]||(l[1]=u=>f.params.expressions[1].value=u),style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(T,null,{default:t(()=>[e(x,{type:"primary",icon:"Search",round:"",onClick:b},{default:t(()=>[...l[9]||(l[9]=[g("查询",-1)])]),_:1})]),_:1}),e(n,null,{default:t(()=>[e(x,{type:"success",icon:"CirclePlus",onClick:D},{default:t(()=>[...l[10]||(l[10]=[g("新增",-1)])]),_:1}),e(F,{title:"确定要删除吗？",onConfirm:l[2]||(l[2]=u=>H())},{reference:t(()=>[e(x,{type:"danger",icon:"Remove"},{default:t(()=>[...l[11]||(l[11]=[g("删除",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),main:t(()=>[Y((I(),A(p,{ref_key:"tableRef",ref:P,style:{width:"100%"},height:"100%",data:j.value,"highlight-current-row":"",stripe:"","show-overflow-tooltip":""},{default:t(()=>[e(i,{fixed:"left",type:"selection",width:"40"}),e(i,{prop:"dictCode",label:"字典代码","min-width":"150"}),e(i,{prop:"dictName",label:"字典名称","min-width":"150"}),e(i,{prop:"dictRemark",label:"备注","min-width":"200"}),e(i,{prop:"dictEnable",label:"状态","min-width":"100"},{default:t(u=>[e(d,{modelValue:u.row.dictEnable,"onUpdate:modelValue":q=>u.row.dictEnable=q,"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用","before-change":()=>!1,size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(i,{prop:"action",label:"操作","min-width":100,fixed:"right",align:"center"},{default:t(u=>[e(x,{type:"primary",size:"small",title:"编辑",icon:"Edit",onClick:q=>N(u.row),circle:""},null,8,["onClick"]),e(F,{title:"确定要删除吗？",onConfirm:q=>o(u.row)},{reference:t(()=>[e(x,{type:"danger",size:"small",title:"删除",icon:"Remove",circle:""})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[J,V.value]])]),footer:t(()=>[e(E,{"current-page":f.params.page,"onUpdate:currentPage":l[3]||(l[3]=u=>f.params.page=u),"page-size":f.params.size,"onUpdate:pageSize":l[4]||(l[4]=u=>f.params.size=u),total:f.params.total,layout:W(M).pageInfo.layout,"page-sizes":W(M).pageInfo.pageSizes,"pager-count":5,onChange:b,background:"",size:"small"},null,8,["current-page","page-size","total","layout","page-sizes"])]),_:1}),e(_,{modelValue:U.value,"onUpdate:modelValue":l[7]||(l[7]=u=>U.value=u),title:"字典详情",width:"800",onClose:l[8]||(l[8]=u=>B.value?.reset())},{footer:t(()=>[e(x,{onClick:l[5]||(l[5]=()=>U.value=!1)},{default:t(()=>[...l[12]||(l[12]=[g("关闭",-1)])]),_:1}),e(x,{type:"primary",onClick:l[6]||(l[6]=()=>B.value?.save())},{default:t(()=>[...l[13]||(l[13]=[g("保存",-1)])]),_:1})]),default:t(()=>[e(Ve,{ref_key:"formRef",ref:B,onOnSave:b},null,512)]),_:1},8,["modelValue"])],64)}}};export{ke as default};
